<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Ezequiel Toum" />

<meta name="date" content="2021-01-22" />

<title>Chapter 2: A lumped model</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Chapter 2: A lumped model</h1>
<h4 class="author">Ezequiel Toum</h4>
<h4 class="date">2021-01-22</h4>



<div id="the-problem" class="section level2">
<h2>The problem</h2>
<p>The following example is what I consider the first step to understand how <strong>HBV.IANIGLA</strong> works. As a first approach, I propose you to fit the streamflow discharge in a synthetic lumped catchment case (in my opinion this the most simple hydrological modeling case). The objectives of this excersice are:</p>
<ul>
<li>to introduce the building-up of the model.</li>
<li>to get a first approach to parameter calibration.</li>
<li>to fit the streamflow discharge in a perfect match case (this does not occur in real world hydrology).</li>
<li>to make a sensitivity analysis.</li>
</ul>
</div>
<div id="data" class="section level2">
<h2>Data</h2>
<p>Initially, we load the dataset containing all the necessary information to run the model: air temperature, precipitation, potential evapotranspiration and the outflow of our synthetic catchment:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(HBV.IANIGLA)</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">data</span>(<span class="st">&quot;lumped_hbv&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">head</span>(lumped_hbv)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt;         Date T(ºC) P(mm/d) PET(mm/d) qout(mm/d)</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; 1 2000-12-16 12.72       0      0.00       0.00</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; 2 2000-12-17 15.23       0     20.00       0.63</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; 3 2000-12-18 15.31       0     19.99       0.74</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; 4 2000-12-19 12.82       0     19.99       0.63</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; 5 2000-12-20 10.45       0     19.98       0.53</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; 6 2000-12-21 11.05       0     19.96       0.43</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">summary</span>(lumped_hbv)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt;       Date                T(ºC)             P(mm/d)         PET(mm/d)     </span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt;  Min.   :2000-12-16   Min.   :-17.0300   Min.   : 0.000   Min.   : 0.000  </span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt;  1st Qu.:2004-08-04   1st Qu.:  0.0025   1st Qu.: 0.000   1st Qu.: 2.960  </span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt;  Median :2008-03-23   Median :  5.8550   Median : 0.000   Median : 9.910  </span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt;  Mean   :2008-03-23   Mean   :  5.0681   Mean   : 1.183   Mean   : 9.992  </span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">#&gt;  3rd Qu.:2011-11-10   3rd Qu.: 10.6375   3rd Qu.: 0.000   3rd Qu.:17.040  </span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">#&gt;  Max.   :2015-06-30   Max.   : 17.6600   Max.   :97.800   Max.   :20.000  </span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">#&gt;    qout(mm/d)   </span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">#&gt;  Min.   :0.000  </span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co">#&gt;  1st Qu.:0.040  </span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">#&gt;  Median :0.050  </span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">#&gt;  Mean   :0.409  </span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">#&gt;  3rd Qu.:0.250  </span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">#&gt;  Max.   :8.230</span></span></code></pre></div>
</div>
<div id="building-the-model" class="section level2">
<h2>Building the model</h2>
<p>This case is about a catchment without glaciers. In the next lines I will help you to build-up the model line by line. Because is our first excersice, I will provide you with the correct <em>initial conditions</em> and <em>parameters</em> in all modules except for the <strong>Routing_HBV</strong> function.</p>
<p>Remember that hydrological models are generally build in a top down direction (from precipitation to streamflow routing - note that most hydrological books are structured in the same way).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># we first consider the SnowGlacier module to take into account </span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># precipitation partioning and the snow accumulation/melting. </span></span>
<span id="cb2-3"><a href="#cb2-3"></a>snow_module &lt;-</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="st">  </span><span class="kw">SnowGlacier_HBV</span>(<span class="dt">model =</span> <span class="dv">1</span>, </span>
<span id="cb2-5"><a href="#cb2-5"></a>                  <span class="dt">inputData =</span> <span class="kw">as.matrix</span>( lumped_hbv[ , <span class="kw">c</span>(<span class="st">&#39;T(ºC)&#39;</span>, <span class="st">&#39;P(mm/d)&#39;</span>)] ),</span>
<span id="cb2-6"><a href="#cb2-6"></a>                  <span class="dt">initCond =</span> <span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">2</span>), </span>
<span id="cb2-7"><a href="#cb2-7"></a>                  <span class="dt">param =</span> <span class="kw">c</span>(<span class="fl">1.20</span>, <span class="fl">1.00</span>, <span class="fl">0.00</span>, <span class="fl">2.5</span>) )</span>
<span id="cb2-8"><a href="#cb2-8"></a></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co"># is always advisable to take a look at the output (unless until you get familiarised </span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># with the model) </span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="kw">head</span>(snow_module)</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt;      Prain Psnow SWE Msnow Total</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; [1,]     0     0   0    20    20</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; [2,]     0     0   0     0     0</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; [3,]     0     0   0     0     0</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; [4,]     0     0   0     0     0</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; [5,]     0     0   0     0     0</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; [6,]     0     0   0     0     0</span></span>
<span id="cb2-19"><a href="#cb2-19"></a></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co"># now see the function documentation...you should be able to relate the model option</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co"># with the matrix output!</span></span></code></pre></div>
<p>Now we will pass the total water produced (rainfall plus snowmelt) to the soil routine. Note that we will use the potential evapotranspiration series,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>soil_module &lt;-</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span><span class="kw">Soil_HBV</span>(<span class="dt">model =</span> <span class="dv">1</span>,</span>
<span id="cb3-3"><a href="#cb3-3"></a>           <span class="dt">inputData =</span> <span class="kw">cbind</span>(snow_module[ , <span class="st">&quot;Total&quot;</span>], lumped_hbv<span class="op">$</span><span class="st">`</span><span class="dt">PET(mm/d)</span><span class="st">`</span>),</span>
<span id="cb3-4"><a href="#cb3-4"></a>           <span class="dt">initCond =</span> <span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb3-5"><a href="#cb3-5"></a>           <span class="dt">param =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="fl">0.8</span>, <span class="fl">1.15</span>) )</span>
<span id="cb3-6"><a href="#cb3-6"></a></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">head</span>(soil_module)</span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;          Rech       Eac        SM</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; [1,] 9.012505  0.000000 110.98750</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; [2,] 0.000000 13.873437  97.11406</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; [3,] 0.000000 12.133188  84.98087</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; [4,] 0.000000 10.617298  74.36357</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; [5,] 0.000000  9.286151  65.07742</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; [6,] 0.000000  8.118408  56.95901</span></span></code></pre></div>
<p>from this module we can get the actual evapotranspiration, soil moisture and recharge series. In the next step we incorporate the last variable to the routing function. Remember that the module’s parameters (<em>param</em> argument) are not calibrated!</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>routing_module &lt;-</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span><span class="kw">Routing_HBV</span>(<span class="dt">model =</span> <span class="dv">1</span>, </span>
<span id="cb4-3"><a href="#cb4-3"></a>              <span class="dt">lake =</span> F, </span>
<span id="cb4-4"><a href="#cb4-4"></a>              <span class="dt">inputData =</span> <span class="kw">as.matrix</span>(soil_module[ , <span class="st">&quot;Rech&quot;</span>]),</span>
<span id="cb4-5"><a href="#cb4-5"></a>              <span class="dt">initCond =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb4-6"><a href="#cb4-6"></a>              <span class="dt">param =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.5</span>, <span class="fl">0.01</span>) )</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">head</span>(routing_module)</span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt;               Qg        Q0          Q1           Q2        STZ       SUZ</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; [1,] 0.000000000 0.0000000 0.000000000 0.000000e+00 9.01250463 0.0000000</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; [2,] 7.661254163 7.6612542 0.000000000 0.000000e+00 0.85125046 0.5000000</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; [3,] 0.326035416 0.3161254 0.009900000 1.000000e-05 0.03512505 0.9801000</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; [4,] 0.010072240 0.0000000 0.010052250 1.999000e-05 0.00000000 0.9951728</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">#&gt; [5,] 0.009881698 0.0000000 0.009851728 2.997001e-05 0.00000000 0.9753211</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">#&gt; [6,] 0.009693151 0.0000000 0.009653211 3.994004e-05 0.00000000 0.9556679</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">#&gt;             SLZ</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co">#&gt; [1,] 0.00000000</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co">#&gt; [2,] 0.00000000</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co">#&gt; [3,] 0.00999000</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">#&gt; [4,] 0.01997001</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="co">#&gt; [5,] 0.02994004</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="co">#&gt; [6,] 0.03990010</span></span></code></pre></div>
<p>Finally we will apply the transfer function in order to adjust the hydrograph timing,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>tf_module &lt;-</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">round</span>( </span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="kw">UH</span>(<span class="dt">model =</span> <span class="dv">1</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>       <span class="dt">Qg =</span> routing_module[ , <span class="st">&quot;Qg&quot;</span>],</span>
<span id="cb5-5"><a href="#cb5-5"></a>       <span class="dt">param =</span> <span class="kw">c</span>(<span class="fl">1.5</span>) ),</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="dv">2</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co"># let&#39;s plot the &quot;true&quot; and simulated hydrographs</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="kw">plot</span>( <span class="dt">x =</span> lumped_hbv[ , <span class="st">&quot;Date&quot;</span>], </span>
<span id="cb5-10"><a href="#cb5-10"></a>      <span class="dt">y =</span> tf_module,</span>
<span id="cb5-11"><a href="#cb5-11"></a>      <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Date&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;q(mm/d)&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="kw">lines</span>(<span class="dt">x =</span> lumped_hbv[ , <span class="st">&quot;Date&quot;</span>],</span>
<span id="cb5-14"><a href="#cb5-14"></a>      <span class="dt">y =</span> lumped_hbv[ , <span class="st">&quot;qout(mm/d)&quot;</span>], </span>
<span id="cb5-15"><a href="#cb5-15"></a>      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># you can get a goodness of fit measurement by, </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">cor</span>(<span class="dt">x =</span> lumped_hbv[ , <span class="st">&quot;qout(mm/d)&quot;</span>], <span class="dt">y =</span> tf_module)</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; [1] 0.7486402</span></span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co"># hint: to use hydrological goodness of fit functions (e.g.: NSE - Nash-Sutcliffe</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co"># Efficiency) you can install the hydroGOF package.</span></span></code></pre></div>
<p>As you will note, our HBV model needs some calibration (in he <strong>Routing_HBV</strong> parameters).</p>
<p><strong>Now is your turn</strong></p>
<blockquote>
<p>change (manually) the corresponding parameter values to get a <em>decent</em> streamflow simulation. <strong>Help</strong>: the order of magnitude of the actual parameters is correct (e.g.: the real value of <em>K0</em> is between 0.9 and 0.1 and so on).</p>
</blockquote>
<p><strong>Hints</strong></p>
<blockquote>
<p>When you are changing the parameters ‘by hand’ is always advisable to plot the results.</p>
</blockquote>
<blockquote>
<p>Pay attention on how sensible is the result to changes in a single parameter.</p>
</blockquote>
</div>
<div id="the-hbv-model-as-a-function" class="section level2">
<h2>The HBV model as a function</h2>
<p>In my view, when building an HBV model is always a better idea to construct a succinct version of it by defining a function. If your are new in the <strong>R</strong> language I recommend to visit one of the following web pages,</p>
<ul>
<li><a href="https://www.r-bloggers.com/2016/05/how-to-make-a-function-in-r/">R bloggers</a></li>
<li><a href="https://adv-r.hadley.nz/functions.html?q=func#functions">Advanced R</a></li>
</ul>
<p>Now lets recycle the previous code to create a general purpose function for lumped basin cases,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## brief arguments desription</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="co"># basin: data frame with the same structure of the data(&quot;lumped_hbv&quot;) (colnames included).</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="co"># param_snow: numeric vector with snow module parameters.</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="co"># param_soil: numeric vector with soil moisture parameters.</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="co"># param_routing: numeric vector with the routing parameters.</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="co"># param_tf: numeric vector with the transfer function parameter.</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  <span class="co"># init_snow: numeric value with initial snow water equivalent. Default value being 20 mm.</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="co"># init_soil: numeric value with initial soil moisture content. Default value being 100 mm.</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>  <span class="co"># init_routing: numeric vector with bucket water initial values. Default values are 0 mm.</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">## output</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="co"># simulated streamflow series.</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>hbv_lumped &lt;-<span class="st"> </span><span class="cf">function</span>(basin, </span>
<span id="cb7-13"><a href="#cb7-13"></a>                       param_snow,</span>
<span id="cb7-14"><a href="#cb7-14"></a>                       param_soil,</span>
<span id="cb7-15"><a href="#cb7-15"></a>                       param_routing,</span>
<span id="cb7-16"><a href="#cb7-16"></a>                       param_tf, </span>
<span id="cb7-17"><a href="#cb7-17"></a>                       <span class="dt">init_snow =</span> <span class="dv">20</span>, </span>
<span id="cb7-18"><a href="#cb7-18"></a>                       <span class="dt">init_soil =</span> <span class="dv">100</span>,</span>
<span id="cb7-19"><a href="#cb7-19"></a>                       <span class="dt">init_routing =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb7-20"><a href="#cb7-20"></a>                       ){</span>
<span id="cb7-21"><a href="#cb7-21"></a>  </span>
<span id="cb7-22"><a href="#cb7-22"></a>  snow_module &lt;-</span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="st">  </span><span class="kw">SnowGlacier_HBV</span>(<span class="dt">model =</span> <span class="dv">1</span>, </span>
<span id="cb7-24"><a href="#cb7-24"></a>                  <span class="dt">inputData =</span> <span class="kw">as.matrix</span>( basin[ , <span class="kw">c</span>(<span class="st">&#39;T(ºC)&#39;</span>, <span class="st">&#39;P(mm/d)&#39;</span>)] ),</span>
<span id="cb7-25"><a href="#cb7-25"></a>                  <span class="dt">initCond =</span> <span class="kw">c</span>(init_snow, <span class="dv">2</span>), </span>
<span id="cb7-26"><a href="#cb7-26"></a>                  <span class="dt">param =</span> param_snow )</span>
<span id="cb7-27"><a href="#cb7-27"></a>  </span>
<span id="cb7-28"><a href="#cb7-28"></a>  soil_module &lt;-</span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="st">  </span><span class="kw">Soil_HBV</span>(<span class="dt">model =</span> <span class="dv">1</span>,</span>
<span id="cb7-30"><a href="#cb7-30"></a>           <span class="dt">inputData =</span> <span class="kw">cbind</span>(snow_module[ , <span class="st">&quot;Total&quot;</span>], basin<span class="op">$</span><span class="st">`</span><span class="dt">PET(mm/d)</span><span class="st">`</span>),</span>
<span id="cb7-31"><a href="#cb7-31"></a>           <span class="dt">initCond =</span> <span class="kw">c</span>(init_soil, <span class="dv">1</span>),</span>
<span id="cb7-32"><a href="#cb7-32"></a>           <span class="dt">param =</span> param_soil )</span>
<span id="cb7-33"><a href="#cb7-33"></a>  </span>
<span id="cb7-34"><a href="#cb7-34"></a> routing_module &lt;-</span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="st">  </span><span class="kw">Routing_HBV</span>(<span class="dt">model =</span> <span class="dv">1</span>, </span>
<span id="cb7-36"><a href="#cb7-36"></a>              <span class="dt">lake =</span> F, </span>
<span id="cb7-37"><a href="#cb7-37"></a>              <span class="dt">inputData =</span> <span class="kw">as.matrix</span>(soil_module[ , <span class="st">&quot;Rech&quot;</span>]),</span>
<span id="cb7-38"><a href="#cb7-38"></a>              <span class="dt">initCond =</span> init_routing, </span>
<span id="cb7-39"><a href="#cb7-39"></a>              <span class="dt">param =</span> param_routing )</span>
<span id="cb7-40"><a href="#cb7-40"></a> </span>
<span id="cb7-41"><a href="#cb7-41"></a> tf_module &lt;-</span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="st">     </span><span class="kw">UH</span>(<span class="dt">model =</span> <span class="dv">1</span>,</span>
<span id="cb7-43"><a href="#cb7-43"></a>       <span class="dt">Qg =</span> routing_module[ , <span class="st">&quot;Qg&quot;</span>],</span>
<span id="cb7-44"><a href="#cb7-44"></a>       <span class="dt">param =</span> param_tf )</span>
<span id="cb7-45"><a href="#cb7-45"></a> </span>
<span id="cb7-46"><a href="#cb7-46"></a> </span>
<span id="cb7-47"><a href="#cb7-47"></a> out &lt;-<span class="st"> </span><span class="kw">round</span>(tf_module, <span class="dv">2</span>)</span>
<span id="cb7-48"><a href="#cb7-48"></a> </span>
<span id="cb7-49"><a href="#cb7-49"></a> <span class="kw">return</span>(out)</span>
<span id="cb7-50"><a href="#cb7-50"></a>  </span>
<span id="cb7-51"><a href="#cb7-51"></a>                       }</span></code></pre></div>
<p>After running this chunk of code you should see the function name in the <strong>Global Environment</strong>, now you can use it.</p>
<p><strong>Advice</strong></p>
<blockquote>
<p>When I use my own functions I usually write them in a separate R file. This helps me to keep my main script clean. To call the function you just run the single code line <em>source(file = “my_hbv_model.R”)</em> and <em>voila</em>!!!…the function is ready to use.</p>
</blockquote>
<p>Note that we have defined default values for all the initial conditions. This means that when running the function, you don’t have to give them a value. For the sake of simplicity I gave them the correct values…so as this is our first case example forget about them and <strong>focus on the other function arguments</strong>.</p>
<p><strong>Now is your turn</strong></p>
<ul>
<li>If you didn’t understand the logic behind the function is a good idea to take a break (and maybe a breath) and revisit the (first) recommended web page <a href="https://www.r-bloggers.com/2016/05/how-to-make-a-function-in-r/">R bloggers</a>. It is advisable to reproduce and <em>play</em> a little bit with the web page examples. <strong>Programming is a necessary condition to learn how to program!</strong>.</li>
<li>Analyze carefully how the function arguments and modules’ outputs are used by the subsequent HBV functions, and how the function’s returning value is set. Without looking at the <em>hbv_lumped</em> example, can you do it by your own?</li>
<li>Now suppose that you want to use the <strong>Routing_HBV</strong> model number two: what do you need to modify? is the <em>param_routing</em> argument of the same length? what about the <em>init_routing</em> argument?</li>
</ul>
</div>
<div id="using-the-function-to-run-the-model" class="section level2">
<h2>Using the function to run the model</h2>
<p>In this section we are going to make something that looks more closely to what we should do in real-world problems: work with the arguments of an HBV function. Imagine what will happen if you decide to build-up a model every time you work in a modeling problem…it will be too prone error! To avoid pitfall it would be a better idea to construct a general purpose function.</p>
<p>In the following lines we are going to use our <em>hbv_lumped</em> model to calibrate the routing parameters in order to fit the simulated streamflow discharge.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># one of the ideas behind a function is to succinctly express </span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co"># operations that will look complicated or too large. In our </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># case, by modifying (in the same line of arguments) just some</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co"># parameters we obtain the basin discharge</span></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a>streamflow &lt;-<span class="st"> </span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="st">  </span><span class="kw">hbv_lumped</span>(<span class="dt">basin =</span> lumped_hbv, </span>
<span id="cb8-8"><a href="#cb8-8"></a>             <span class="dt">param_snow =</span> <span class="kw">c</span>(<span class="fl">1.20</span>, <span class="fl">1.00</span>, <span class="fl">0.00</span>, <span class="fl">2.5</span>),</span>
<span id="cb8-9"><a href="#cb8-9"></a>             <span class="dt">param_soil =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="fl">0.8</span>, <span class="fl">1.15</span>),</span>
<span id="cb8-10"><a href="#cb8-10"></a>             <span class="dt">param_routing =</span> <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.01</span>, <span class="fl">0.005</span>, <span class="fl">0.75</span>, <span class="fl">0.15</span>),</span>
<span id="cb8-11"><a href="#cb8-11"></a>             <span class="dt">param_tf =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="kw">plot</span>( <span class="dt">x =</span> lumped_hbv[ , <span class="st">&quot;Date&quot;</span>], </span>
<span id="cb8-14"><a href="#cb8-14"></a>      <span class="dt">y =</span> streamflow,</span>
<span id="cb8-15"><a href="#cb8-15"></a>      <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;dodgerblue&quot;</span>,</span>
<span id="cb8-16"><a href="#cb8-16"></a>      <span class="dt">xlab =</span> <span class="st">&quot;Date&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;q(mm/d)&quot;</span>)</span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="kw">lines</span>(<span class="dt">x =</span> lumped_hbv[ , <span class="st">&quot;Date&quot;</span>],</span>
<span id="cb8-18"><a href="#cb8-18"></a>      <span class="dt">y =</span> lumped_hbv[ , <span class="st">&quot;qout(mm/d)&quot;</span>], </span>
<span id="cb8-19"><a href="#cb8-19"></a>      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">cor</span>(<span class="dt">x =</span> streamflow, <span class="dt">y =</span>  lumped_hbv[ , <span class="st">&quot;qout(mm/d)&quot;</span>] )</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">#&gt; [1] 0.956788</span></span></code></pre></div>
<p>Now you have a compact expression for your modeling problem. Recycling this kind of functions will also save you a lot of time. Be also aware that you only have to build them <strong>once</strong>!</p>
<p><strong>Now is your turn</strong></p>
<ul>
<li>if you haven’t, get the perfect (or unless an almost perfect) streamflow fit.</li>
<li>change another parameter(s) and see what happen with the hydrograph.</li>
</ul>
</div>
<div id="sensitivity-analysis" class="section level2">
<h2>Sensitivity analysis</h2>
<p>According to <span class="citation">Beven (2008)</span> a sensitivity analysis is:</p>
<blockquote>
<p>the response of a model to a change in a parameter or input variable. This reaction can either be assesed locally in the model space or over a global sample of points.</p>
</blockquote>
<p>In this part of our <strong>lumped model vignette</strong>, I will give you the answer to our calibration problem and we are going to make a sensitivity analysis on them.</p>
<p><strong>Rounting_HBV parameters:</strong> <code>c(0.1, 0.05, 0.002, 0.9, 0.1)</code></p>
<p>One way to look at the sensitivity of a single parameter, is to change its value in a reasonable range to evaluate some model response(s) (in our case, the basin discharge) <span class="citation">(Pianosi et al. 2016)</span>. In this example our evaluation measurement will be the Pearson correlation coefficient.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># first we are going to generate a vector with the possible values</span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># of our parameter. Let&#39;s say that we want to evaluate the effect of</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># changing the K0 value.</span></span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a>target_param &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.1</span>, <span class="dt">to =</span> <span class="fl">0.9</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co"># now we get the number fo required iterations and we create an empty </span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co"># vector to store the evaluation function results</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>n_it     &lt;-<span class="st"> </span><span class="kw">length</span>(target_param)</span>
<span id="cb10-10"><a href="#cb10-10"></a>response &lt;-<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb10-11"><a href="#cb10-11"></a></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co"># finally run our function n_it times and we plot the results</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_it){</span>
<span id="cb10-14"><a href="#cb10-14"></a>  </span>
<span id="cb10-15"><a href="#cb10-15"></a>  streamflow &lt;-<span class="st"> </span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="st">  </span><span class="kw">hbv_lumped</span>(<span class="dt">basin =</span> lumped_hbv, </span>
<span id="cb10-17"><a href="#cb10-17"></a>             <span class="dt">param_snow =</span> <span class="kw">c</span>(<span class="fl">1.20</span>, <span class="fl">1.00</span>, <span class="fl">0.00</span>, <span class="fl">2.5</span>),</span>
<span id="cb10-18"><a href="#cb10-18"></a>             <span class="dt">param_soil =</span> <span class="kw">c</span>(<span class="dv">200</span>, <span class="fl">0.8</span>, <span class="fl">1.15</span>),</span>
<span id="cb10-19"><a href="#cb10-19"></a>             <span class="dt">param_routing =</span> <span class="kw">c</span>(target_param[i], <span class="fl">0.05</span>, <span class="fl">0.002</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>),</span>
<span id="cb10-20"><a href="#cb10-20"></a>             <span class="dt">param_tf =</span> <span class="kw">c</span>(<span class="fl">1.5</span>))</span>
<span id="cb10-21"><a href="#cb10-21"></a></span>
<span id="cb10-22"><a href="#cb10-22"></a>  response[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(<span class="dt">x =</span> streamflow, <span class="dt">y =</span>  lumped_hbv[ , <span class="st">&quot;qout(mm/d)&quot;</span>] )</span>
<span id="cb10-23"><a href="#cb10-23"></a>  </span>
<span id="cb10-24"><a href="#cb10-24"></a>}</span>
<span id="cb10-25"><a href="#cb10-25"></a></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="kw">plot</span>(<span class="dt">x =</span> target_param, <span class="dt">y =</span> response, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>,</span>
<span id="cb10-27"><a href="#cb10-27"></a>     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><strong>Now is your turn</strong></p>
<ul>
<li>explore what happen if the target value is another parameter.</li>
<li>try not only with the <strong>Routing_HBV</strong> parameters, but with the other modules.</li>
<li>which model parameters are the most sensible for streamflow discharge?</li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-beven:2008">
<p>Beven, Keith. 2008. <em>Environmental Modelling: An Uncertain Future?</em> 1 edition. London: CRC Press.</p>
</div>
<div id="ref-pianosi:2016">
<p>Pianosi, Francesca, Keith Beven, Jim Freer, Jim W. Hall, Jonathan Rougier, David B. Stephenson, and Thorsten Wagener. 2016. “Sensitivity Analysis of Environmental Models: A Systematic Review with Practical Workflow.” <em>Environmental Modelling &amp; Software</em> 79 (May): 214–32. <a href="https://doi.org/10.1016/j.envsoft.2016.02.008">https://doi.org/10.1016/j.envsoft.2016.02.008</a>.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
